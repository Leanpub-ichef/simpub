<nav class="layout-navbar navbar navbar-dark bg-black px-5">
  <div class="col-1">
    <a href="/" class="navbar-brand d-flex"><%= image_pack_tag "logo.png", class: "w-100 img-responsive" %></a>
	</div>
  
  <!-- 書搜尋頁 -->
  <%= link_to "Books", books_path, class: "nav-item main-color mr-3 " %>
  
  <% if user_signed_in?  %>
    <!-- 個人書櫃 -->
    <%= link_to "Library", :library, class: "nav-item mr-3  main-color" %>
    <a href="/purchase" class="nav-item main-color mr-3 ">Purchase</a>

    <!-- 寫書 -->
    <%= link_to "Create a Book", :new_book, class: "nav-item mr-3  main-color" %>
      
      <!-- 寫過的書 -->
    <% if current_user.pub_books.count > 0 %>
    <%= link_to "My Writings", dash_board_books_path, class: "nav-item main-color mr-3 " %>
    <% end %>
    
  <% end %>

  <!-- navSearch -->
  <%= form_with(url: :books, method: :get, class: "nav-search form-inline ml-auto", local: true) do |f| %>
    <%= f.search_field :search, class: "search-input form-control mr-sm-2", placeholder: "Search" %>
    <%= f.button :submit, class: "search-btn btn btn-outline-black my-2 my-sm-0" do %>
      <i class="fas fa-search main-color"></i>
    <% end %>
  <% end %>
  <!--
  <form class="form-inline ml-auto">
    <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
    <%= link_to  books_path, class: "btn btn-outline-black my-2 my-sm-0" do  %>
      <i class="fas fa-search main-color"></i>
    <% end %>
  </form>
  -->
  <div class="mx-2 d-flex flex-row">
    <!-- 購物車 -->
    <%= link_to cart_path do %>
      <i class="nav-icon mg-auto mx-2 fas fa-shopping-cart main-color">
        <div class="x"></div>
      </i>
    <% end %>
    <% if user_signed_in? %>
      <%# <a href="#">
        <i class="nav-icon mg-auto mx-2 fas fa-heart main-color"></i>
      </a>
      <a href="#">
        <i class="nav-icon mg-auto mx-2 fas fa-bell main-color"></i>
      </a> %>
    <% else %>
      <%= link_to "Sign up", new_user_registration_path ,class: "mx-2 main-color" %>
      <%= link_to "Sign in", new_user_session_path ,class: "mx-2 main-color" %>
    <% end %>
  </div>

  <!-- 下拉選單 -->
  <% if user_signed_in?  %>
    <div class="fix-down">
      <nav class="navbar navbar-dark bg-black">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      </nav>
    </div>
    
    <div class="layout-dropdown collapse position-absolute w-100 ml-auto" id="navbarToggleExternalContent">
      <div class="layout-dropdown-child position-absolute bg-black px-4 py-1 ml-auto col-2 col-lg-2">
        <div class="row mx-auto align-items-center">
          <div class="nav-avatar">
            <div>
              <%= render "shared/frontend/user_avatar", user: current_user %>
            </div>
          </div>
          <div>
            <p class= "nav-user-info my-0 px-2"><%= current_user.name %></p> 
            <p class= "nav-user-info my-0 px-2"><%= current_user.email %></p> 
          </div>
        </div>

        <!-- 作者主頁 (有創建過書籍才會顯示) -->
        <% if current_user.pub_books.count > 0 %>
          <div class="py-2 d-flex">
            <%= link_to "Author", dash_board_books_path, class: "nav-drop-item container-fluid" %>
          </div>
        <% end %>
        <!-- 寫書 -->
        <div class="py-2 d-flex">
          <%= link_to "Create a Book", :new_book, class: "nav-drop-item container-fluid" %>
        </div>
        <!-- 個人書櫃 -->
        <div class="py-2 d-flex">
          <%= link_to "Library", :library, class: "nav-drop-item container-fluid" %>
        </div>
        <!-- 編輯個人資料 -->
        <div class="py-2 d-flex">
          <%= link_to "Edit Profile", user_dashboard_path, class: "nav-drop-item container-fluid"%>
        </div>
        <!-- 檢視個人主頁 -->
        <div class="py-2 d-flex">
          <%= link_to "View Profile", profile_path(current_user.username), class: "nav-drop-item container-fluid"%>
        </div>
        <!-- 登出 -->
        <div class="py-2 d-flex">
          <%= link_to "Sign Out", :destroy_user_session, method: :delete, class: "sign_out_btn container-fluid"%>
        </div>
      </div>
    </div>
  <% end %>
</nav>